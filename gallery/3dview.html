<!DOCTYPE html>
<html>
     <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,minimum-scale=1.0,user-scalable=0" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <title>三维漫游</title>
		<link href="./css/widgets.css" rel="stylesheet">
		<link href="./css/bootstrap.min.css" rel="stylesheet">
		<link href="./css/pretty.css" rel="stylesheet">
		<script src="./js/jquery.min.js"></script>
		<script src="./js/bootstrap.min.js"></script>
		<script src="./js/bootstrap-select.min.js"></script>
		<script src="./js/config.js"></script>
		<script type="text/javascript" src="./js/require.min.js" data-main="js/main"></script>
	<div class="row" style="height:120px;"> <a class="navbar-toggle hidden-sm hidden-md hidden-lg " href="javascript:void(0)" data-toggle="collapse" data-target=".navbar-collapse"><i class="fa fa-bars"></i></a>
				  <p><p><p><p> <font weight="7000" face="STLiti" size="+4" color="red" style="margin-left:5%"><img src="img/hos.jpg" alt="user-img" width="50" class="img-circle">三维漫游</font></a><span class="hidden-xs"></span></a>
				<p><p><p><p>
	</div>
		<style>
        #play {
            content: url(./img/play.png);
            height: 30px;
            padding: 5px;
        }

        #pause {
            content: url(./img/pause.png);
            height: 30px;
            padding: 5px;
        }

        #stop {
            content: url(./img/stop.png);
            height: 30px;
            padding: 5px;
        }
        #play1 {
            content: url(./img/play.png);
            height: 30px;
            padding: 5px;
        }

        #pause1 {
            content: url(./img/pause.png);
            height: 30px;
            padding: 5px;
        }

        #stop1 {
            content: url(./img/stop.png);
            height: 30px;
            padding: 5px;
        }
        .bootstrap-select {
            width: 150px;
        }
    </style>
	</head>	
	<body>
<div id="cesiumContainer"></div>
<div id='loadingbar' class="spinner">
    <div class="spinner-container container1">
        <div class="circle1"></div>
        <div class="circle2"></div>
        <div class="circle3"></div>
        <div class="circle4"></div>
    </div>
    <div class="spinner-container container2">
        <div class="circle1"></div>
        <div class="circle2"></div>
        <div class="circle3"></div>
        <div class="circle4"></div>
    </div>
    <div class="spinner-container container3">
        <div class="circle1"></div>
        <div class="circle2"></div>
        <div class="circle3"></div>
        <div class="circle4"></div>
    </div>
</div>
<div id='toolbar' class="param-container tool-bar" style="margin-left:4%;margin-top:5%">
		  <p>  <div style="margin-left:5%;margin-bottom:2%">

                 <button onclick="window.location.href = './index.html'" >返回主页</a></button>
                 <button onclick="window.location.href = './search.html'" >信息查询</a></button>
            </div>	<p>  
   <p> <a id="A1" >室内线路：</a>	
<p>   
    <span type="button" id="play" class="button black" title="开始"></span>
    <span type="button" id="pause" class="button black" title="暂停"></span>
    <span type="button" id="stop" class="button black" title="停止"></span>	
    <div style="width: 150px;">
        <select id="stopList" class="form-control" style="width: 100%;">
            <!--<option disabled selected value>&#45;&#45;选择站点&#45;&#45;</option>-->
        </select>
    </div>
    <div class="checkbox">
        <label>
            <input type="checkbox" id="show-line" checked> 显示飞行路线
        </label>
    </div>
    <div class="checkbox">
        <label>
            <input type="checkbox" id="show-stop" checked> 显示飞行站点
        </label>
    </div>
   <p> <a id="A1" >室外线路：</a>		
   <p>
    <span type="button" id="play" class="button black" title="开始"></span>
    <span type="button" id="pause" class="button black" title="暂停"></span>
    <span type="button" id="stop" class="button black" title="停止"></span>	
	<div style="width: 150px;">
        <select id="stopList" class="form-control" style="width: 100%;">
            <!--<option disabled selected value>&#45;&#45;选择站点&#45;&#45;</option>-->
        </select>
    </div>
    <div class="checkbox">
        <label>
            <input type="checkbox" id="show-line" checked> 显示飞行路线
        </label>
    </div>
    <div class="checkbox">
        <label>
            <input type="checkbox" id="show-stop" checked> 显示飞行站点
        </label>
    </div>
   <p> <a id="A1" >备注：本例提供了两种</br>三维飞行模式（室内、</br>室外），并可根据站点查</br>看实景，开始按钮触发</br>漫游，暂停按钮暂停漫游，</br>停止按钮结束漫游。</a>		
</div>	
		<script type="text/javascript">
		var viewer;
		function onload(Cesium) {
		    var viewer = new Cesium.Viewer('cesiumContainer');
			var scene = viewer.scene;
			var promise =scene.open('http://localhost:8090/iserver/services/3D-Scence-fangcang/rest/realspace');
                 Cesium.when(promise,function(layer){
                 scene.camera.setView({destination : Cesium.Cartesian3.fromDegrees(114.36548,30.651455555, 10000)
				 });
			var flyManager;
            var routes = new Cesium.RouteCollection();//飞行路线集合
            //添加fpf飞行文件，fpf由SuperMap iDesktop生成
            var fpfUrl = './indoor.fpf';
            routes.fromFile(fpfUrl);
            var flyManager = new Cesium.FlyManager({
                scene: scene,
                routes: routes
            });
            //注册站点到达事件
            flyManager.stopArrived.addEventListener(function (routeStop) {
                routeStop.waitTime = 1; // 在每个站点处停留1s
            });

            flyManager.readyPromise.then(function () { // 飞行路线就绪
                var currentRoute = flyManager.currentRoute;
                currentRoute.isLineVisible = true;
                currentRoute.isStopVisible = true;
                //生成飞行文件中的所有站点列表
                var allStops = flyManager.getAllRouteStops();
                var menu = document.getElementById('stopList');
                for (var i = 0, j = allStops.length; i < j; i++) {
                    var option = document.createElement('option');
                    option.innerHTML = "站点 " + (i + 1);
                    option.value = allStops[i].index;
                    menu.appendChild(option);
                }

                $('#stopList').change(function () { //注册站点切换事件
                    flyManager && flyManager.stop();
                    var index = parseInt($(this).val()); // 站点的索引
                    var route = flyManager.currentRoute;
                    var stop = route.get(index);
                    flyManager.currentStopIndex = index;
                    flyManager.viewToStop(stop);
                });

                $('#play').click(function () {
                    flyManager && flyManager.play();
                });
                $('#pause').click(function () {
                    flyManager && flyManager.pause();
                });
                $('#stop').click(function () {
                    flyManager && flyManager.stop();
                });

                $('#show-line').change(function(){
                    currentRoute.isLineVisible = $(this).prop('checked');
                });

                $('#show-stop').change(function(){
                    currentRoute.isStopVisible = $(this).prop('checked');
                });

                $('#toolbar').show();
                $('#loadingbar').remove();
            });
            });					
		}
		</script>
</div>
    </body><div id="cesiumContainer" style="width:100%; height:100%"></div>
</html>
